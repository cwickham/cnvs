
```{r, setup, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  tidy = FALSE,
  error = FALSE,
  fig.width = 8,
  fig.height = 8)
```

# cnvs

<!-- badges: start -->
  [![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
  <!-- badges: end -->

> Canvas LMS API

Minimalistic client to access the
[Canvas LMS API](https://canvas.instructure.com/doc/api/index.html).

Heavily borrowing from the infrastructure of [gh](https://github.com/r-lib/gh) 

## Installation

Install the package from GitHub as usual:

```{r eval = FALSE}
# install.packages("remotes")
remotes::install_github("cwickham/cnvs")
```

## Usage

```{r}
library(cnvs)
```

Use the `cnvs()` function to access all API endpoints. The endpoints are
listed in the [documentation](https://canvas.instructure.com/doc/api/index.html).

The first argument of `cnvs()` is the endpoint. Note that the leading slash
must be included as well. Parameters can be passed as extra arguments. E.g.

```{r}
my_courses <- cnvs("/courses", enrollment_type = "teacher")
vapply(my_courses, "[[", "", "name")
```

The JSON result sent by the API is converted to an R object.

If the end point itself has parameters, these can also be passed
as extra arguments:

```{r}
vis_modules <- cnvs("/courses/:course_id/modules", 
  course_id = 1724191)
vapply(vis_modules, "[[", "", "name")
```

### POST, PATCH, PUT and DELETE requests

**Not yet tested**

POST, PATCH, PUT, and DELETE requests can be sent by including the
HTTP verb before the endpoint, in the first argument. E.g. to
create a repository:

```{r eval = FALSE}
new_repo <- gh("POST /user/repos", name = "my-new-repo-for-gh-testing")
```

and then delete it:

```{r eval = FALSE}
gh("DELETE /repos/:owner/:repo", owner = "gaborcsardi",
   repo = "my-new-repo-for-gh-testing")
```

### Tokens

By default the `GITHUB_PAT` environment variable is used. Alternatively, 
one can set the `.token` argument of `gh()`.

### Pagination

Supply the `page` parameter to get subsequent pages:

```{r eval = FALSE}
my_repos2 <- gh("GET /users/:username/repos", username = "gaborcsardi",
  type = "public", page = 2)
vapply(my_repos2, "[[", "", "name")
```

## License

cnvs: MIT © Charlotte Wickham

The code is mostly minor edits to the [gh](https://github.com/r-lib/gh) package:

gh: MIT © Gábor Csárdi, Jennifer Bryan, Hadley Wickham
